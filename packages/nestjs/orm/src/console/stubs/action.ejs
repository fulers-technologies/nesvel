import { Injectable } from '@nestjs/common';
import { BaseAction, InjectRepository } from '@nesvel/nestjs-orm';

/**
 * <%= className %> Action
 *
 * Action class for <%= modelName %> business logic.
 * Encapsulates a specific operation or use case related to <%= modelName %>.
 *
 * **Usage:**
 * This action can be injected into controllers or other services to execute
 * the business logic it encapsulates. Actions provide better separation of
 * concerns and make the code more testable and maintainable.
 *
 * @description
 * <%= className %> handles [describe what this action does].
 * It follows the Command pattern where the execute() method contains
 * the core business logic.
 *
 * @example
 * ```typescript
 * // In controller
 * @Controller('<%= variableName %>s')
 * export class <%= modelName %>sController {
 *   constructor(private <%= variableName %>Action: <%= className %>) {}
 *
 *   @Post()
 *   async create(@Body() dto: Create<%= modelName %>Dto) {
 *     return await this.<%= variableName %>Action.execute(dto);
 *   }
 * }
 * ```
 *
 * @author Generated by @nesvel/nestjs-orm
 * @since 1.0.0
 */
@Injectable()
export class <%= className %> extends BaseAction<any, any> {
  /**
   * Creates an instance of <%= className %>
   *
   * @param repository - <%= modelName %> repository for database operations
   *
   * @example
   * ```typescript
   * constructor(
   *   @InjectRepository(<%= modelName %>)
   *   private <%= variableName %>Repository: <%= modelName %>Repository,
   *   // Add other dependencies here
   * ) {
   *   super();
   * }
   * ```
   */
  constructor(
    // Inject dependencies here (repositories, services, etc.)
    // @InjectRepository(<%= modelName %>)
    // private <%= variableName %>Repository: <%= modelName %>Repository,
  ) {
    super();
  }

  /**
   * Execute the <%= className %>
   *
   * Implements the core business logic for this action.
   * This method is called when the action is executed.
   *
   * @param data - Input data for the action
   * @returns Promise resolving to the action result
   *
   * @throws {Error} If the action execution fails
   *
   * @example
   * ```typescript
   * async execute(data: Create<%= modelName %>Dto): Promise<<%= modelName %>> {
   *   // Validate input
   *   this.validateInput(data);
   *
   *   // Perform business logic
   *   const <%= variableName %> = this.<%= variableName %>Repository.create(data);
   *   await this.<%= variableName %>Repository.save(<%= variableName %>);
   *
   *   // Transform and return result
   *   return this.transformOutput(<%= variableName %>);
   * }
   * ```
   */
  async execute(data: any): Promise<any> {
    // TODO: Implement your business logic here
    
    // Example implementation:
    // 1. Validate input data
    // if (!data) {
    //   throw new BadRequestException('Data is required');
    // }
    
    // 2. Perform business logic
    // const result = await this.<%= variableName %>Repository.create(data);
    
    // 3. Return result
    // return result;
    
    this.logger.log('<%= className %> executed successfully');
    return data;
  }

  /**
   * Validate input data
   *
   * Override this method to add custom validation logic.
   * This is called automatically by the handle method before execute.
   *
   * @param data - The input data to validate
   * @throws {BadRequestException} If validation fails
   *
   * @example
   * ```typescript
   * protected validateInput(data: Create<%= modelName %>Dto): void {
   *   if (!data.name) {
   *     throw new BadRequestException('Name is required');
   *   }
   * }
   * ```
   */
  protected validateInput(data: any): void {
    // Add your validation logic here
    super.validateInput(data);
  }

  /**
   * Transform output before returning
   *
   * Override this method to transform or format the action's output.
   * Useful for filtering sensitive data or mapping to DTOs.
   *
   * @param result - The raw result from execute
   * @returns The transformed result
   *
   * @example
   * ```typescript
   * protected transformOutput(<%= variableName %>: <%= modelName %>): <%= modelName %>Dto {
   *   return {
   *     id: <%= variableName %>.id,
   *     name: <%= variableName %>.name,
   *     // Exclude sensitive fields
   *   };
   * }
   * ```
   */
  protected transformOutput(result: any): any {
    // Add your transformation logic here
    return super.transformOutput(result);
  }
}
